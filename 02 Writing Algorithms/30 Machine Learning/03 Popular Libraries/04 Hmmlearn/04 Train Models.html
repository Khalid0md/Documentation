<p>In this example, assume the market has only 2 regimes and the market returns follow a Gaussian distribution. Therefore, create a 2-component Hidden Markov Model with Gaussian emissions, which is equivalent to a Gaussian mixture model with 2 means. Follow these steps to create the model:</p>

<h4>History Call</h4>
<p>You need historical data to train the model. Call <code>History</code> with <code>Symbol</code>, timerule, and resolution to obtain historical data. In this example, 2 years of daily trade bar data is used.</p>
<div class="section-example-container">
    <pre class="python">self.History(self.spy, 252*2, Resolution.Daily)</pre>
</div>

<h4>Prepare Data</h4>
<p>Follow the below steps to create a method to prepare the data for training.</p>
<ol>
    <li>Create a method to process the data for the algorithm class, with input data as arguments.</li>
    <div class="section-example-container">
        <pre class="python">def ProcessData(self, history):</pre>
    </div>

    <li>Call the <code>pct_change</code> and <code>dropna</code> methods.</li>
    <div class="section-example-container">
        <pre class="python">    daily_pct_change = history.pct_change().dropna()</pre>
    </div>

    <li>Call the <code>reshape</code> method.</li>
    <div class="section-example-container">
        <pre class="python">    features = daily_pct_change.values.reshape(-1, 1)</pre>
    </div>

    <li>Return the processed features.</li>
    <div class="section-example-container">
        <pre class="python">    return features</pre>
</ol>

<h4>Build and Fit Model</h4>
<p>Follow the below steps to create a method to build and fit the model.</p>
<ol>
    <li>Get processed training data.</li>
    <div class="section-example-container">
        <pre class="python">features = self.ProcessData(history)</pre>
    </div>

    <li>Call the <code>GaussianHMM</code> constructor with the number of components, a covariance type, and the number of iterations. Save it as a class variable.</li>
    <div class="section-example-container">
        <pre class="python">self.model = hmm.GaussianHMM(n_components=2, covariance_type="full", n_iter=100)</pre>
    </div>

    <li>Call the <code>fit</code> method with the training data.</li>
    <div class="section-example-container">
        <pre class="python">self.model.fit(features)</pre>
    </div>
</ol>